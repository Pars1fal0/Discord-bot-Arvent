{% extends "base.html" %}

{% block title %}{{ guild.name }}{% endblock %}

{% block content %}
<div class="server-layout">
    <!-- Sidebar -->
    <aside class="sidebar glass-card">
        <div class="sidebar-header">
            {% if guild.icon %}
            <img src="https://cdn.discordapp.com/icons/{{ guild.id }}/{{ guild.icon }}.png?size=64"
                alt="{{ guild.name }}" class="sidebar-icon">
            {% else %}
            <div class="sidebar-icon-placeholder">{{ guild.name[0] }}</div>
            {% endif %}
            <h2 class="sidebar-title">{{ guild.name }}</h2>
        </div>

        <nav class="sidebar-nav">
            <a href="{{ url_for('views.server_dashboard', guild_id=guild_id) }}" class="nav-item active">
                <span class="nav-icon">üìä</span>
                <span class="nav-text">–û–±–∑–æ—Ä</span>
            </a>
            <a href="{{ url_for('views.moderation_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üõ°Ô∏è</span>
                <span class="nav-text">–ú–æ–¥–µ—Ä–∞—Ü–∏—è</span>
            </a>
            <a href="{{ url_for('views.logging_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üìã</span>
                <span class="nav-text">–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            </a>
            <a href="{{ url_for('views.tickets_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üé´</span>
                <span class="nav-text">–¢–∏–∫–µ—Ç—ã</span>
            </a>
            <a href="{{ url_for('views.autorole_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üëã</span>
                <span class="nav-text">–ê–≤—Ç–æ—Ä–æ–ª–µ–π</span>
            </a>
            <a href="{{ url_for('views.tempvoice_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üé§</span>
                <span class="nav-text">–í–æ–π—Å-–∫–∞–Ω–∞–ª—ã</span>
            </a>
            <a href="{{ url_for('views.streams_page', guild_id=guild_id) }}" class="nav-item">
                <span class="nav-icon">üì∫</span>
                <span class="nav-text">–°—Ç—Ä–∏–º—ã</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="{{ url_for('views.dashboard') }}" class="nav-item nav-back">
                <span class="nav-icon">‚Üê</span>
                <span class="nav-text">–ù–∞–∑–∞–¥ –∫ —Å–µ—Ä–≤–µ—Ä–∞–º</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="server-content">
        <div class="page-header">
            <h1>üìä –û–±–∑–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞</h1>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid" id="stats-grid">
            <div class="stat-card glass-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-members">‚Äî</span>
                    <span class="stat-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                </div>
            </div>
            <div class="stat-card glass-card">
                <div class="stat-icon">üü¢</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-online">‚Äî</span>
                    <span class="stat-label">–û–Ω–ª–∞–π–Ω</span>
                </div>
            </div>
            <div class="stat-card glass-card">
                <div class="stat-icon">üí¨</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-text-channels">‚Äî</span>
                    <span class="stat-label">–¢–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</span>
                </div>
            </div>
            <div class="stat-card glass-card">
                <div class="stat-icon">üîä</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-voice-channels">‚Äî</span>
                    <span class="stat-label">–ì–æ–ª–æ—Å–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</span>
                </div>
            </div>
            <div class="stat-card glass-card">
                <div class="stat-icon">üé≠</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-roles">‚Äî</span>
                    <span class="stat-label">–†–æ–ª–µ–π</span>
                </div>
            </div>
            <div class="stat-card glass-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-info">
                    <span class="stat-value" id="stat-boosts">‚Äî</span>
                    <span class="stat-label">–ë—É—Å—Ç–æ–≤</span>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="section">
            <h2 class="section-title">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <div class="quick-actions-grid">
                <a href="{{ url_for('views.moderation_page', guild_id=guild_id) }}" class="action-card glass-card">
                    <span class="action-icon">üõ°Ô∏è</span>
                    <h3>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</h3>
                    <p>–§–∏–ª—å—Ç—Ä—ã —Å—Å—ã–ª–æ–∫, –∞–Ω—Ç–∏-—Å–ø–∞–º, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</p>
                </a>
                <a href="{{ url_for('views.logging_page', guild_id=guild_id) }}" class="action-card glass-card">
                    <span class="action-icon">üìã</span>
                    <h3>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
                    <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</p>
                </a>
                <a href="{{ url_for('views.tickets_page', guild_id=guild_id) }}" class="action-card glass-card">
                    <span class="action-icon">üé´</span>
                    <h3>–¢–∏–∫–µ—Ç—ã</h3>
                    <p>–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                </a>
                <a href="{{ url_for('views.autorole_page', guild_id=guild_id) }}" class="action-card glass-card">
                    <span class="action-icon">üëã</span>
                    <h3>–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è</h3>
                    <p>–ê–≤—Ç–æ—Ä–æ–ª–µ–π –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</p>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    const guildId = '{{ guild_id }}';

    // Load stats on page load
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const response = await fetch(`/api/guild/${guildId}/stats`);
            const stats = await response.json();

            document.getElementById('stat-members').textContent = stats.member_count?.toLocaleString() || '‚Äî';
            document.getElementById('stat-online').textContent = stats.online_count?.toLocaleString() || '‚Äî';
            document.getElementById('stat-text-channels').textContent = stats.text_channels || '‚Äî';
            document.getElementById('stat-voice-channels').textContent = stats.voice_channels || '‚Äî';
            document.getElementById('stat-roles').textContent = stats.role_count || '‚Äî';
            document.getElementById('stat-boosts').textContent = stats.boost_count || '0';
        } catch (error) {
            console.error('Error loading stats:', error);
        }
    });
</script>
{% endblock %}